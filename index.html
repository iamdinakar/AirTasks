<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="light dark" />
  <title>AirTasks</title>
  <style>
    :root{
      --bg:#ffffff;
      --panel:#ffffff;
      --text:rgba(0,0,0,.92);
      --muted:rgba(0,0,0,.56);
      --hair:rgba(0,0,0,.10);
      --soft:rgba(0,0,0,.04);
      --focus:rgba(0,0,0,.22);
      --shadow: 0 18px 60px rgba(0,0,0,.08);
      --radius: 20px;
      --radius2: 14px;
      --success:#22c55e;
      --success2:#16a34a;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b0c10;
        --panel:rgba(255,255,255,.06);
        --text:rgba(255,255,255,.92);
        --muted:rgba(255,255,255,.58);
        --hair:rgba(255,255,255,.14);
        --soft:rgba(255,255,255,.06);
        --focus:rgba(255,255,255,.22);
        --shadow: 0 22px 70px rgba(0,0,0,.55);
        --success:#34d399;
        --success2:#16a34a;
      }
    }

    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background:var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      letter-spacing:-0.01em;
    }

    .wrap{
      min-height:100%;
      display:flex;
      justify-content:center;
      padding: clamp(22px, 5vw, 64px);
    }

    .app{
      width:min(920px, 100%);
      display:flex;
      flex-direction:column;
      gap: 18px;
    }

    header{
      display:flex;
      align-items:flex-end;
      justify-content:space-between;
      gap:18px;
      padding: 2px 2px 0 2px;
    }

    .brand{
      display:flex;
      flex-direction:column;
      gap:6px;
    }

    .title{
      font-weight:650;
      font-size: clamp(22px, 2.7vw, 34px);
      line-height:1.1;
    }

    .sub{
      color:var(--muted);
      font-size: 14px;
      line-height:1.35;
      max-width: 52ch;
    }

    .panel{
      background: var(--panel);
      border:1px solid var(--hair);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
      backdrop-filter: blur(10px);
    }

    .composer{
      padding: 18px;
      display:flex;
      gap: 12px;
      align-items:center;
      border-bottom:1px solid var(--hair);
    }

    .field{
      flex:1 1 auto;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 12px 14px;
      border:1px solid var(--hair);
      background: transparent;
      border-radius: var(--radius2);
    }

    .field input{
      width:100%;
      border:0;
      outline:0;
      background: transparent;
      color:var(--text);
      font-size: 16px;
    }

    .btn{
      border:1px solid var(--hair);
      background: transparent;
      color:var(--text);
      border-radius: 999px;
      padding: 10px 12px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      cursor:pointer;
      user-select:none;
      white-space:nowrap;
      text-decoration:none;
    }

    .btn svg{ display:block; }

    .btn:hover{ background: var(--soft); }
    .btn:active{ transform: translateY(1px); }
    .btn:focus-visible{ outline:3px solid var(--focus); outline-offset:2px; }

    .btn .label{ font-size: 14px; }

    .toolbar{
      padding: 12px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap: 12px;
    }

    .meta{
      color:var(--muted);
      font-size: 13px;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .actions{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }

    .ghost{
      border-color: transparent;
      background: transparent;
      color: var(--muted);
      padding: 10px 10px;
    }
    .ghost:hover{ background: var(--soft); color: var(--text); border-color: transparent; }

    ul{
      list-style:none;
      margin:0;
      padding: 6px 10px 16px 10px;
    }

    .row{
      position: relative;
      display:flex;
      align-items:center;
      gap: 12px;
      padding: 12px 12px;
      border-radius: var(--radius2);
      margin: 4px 0;
    }

    .row:hover{ background: var(--soft); }

    /* Celebrate a completed task (green highlight) */
    .celebrate{
      background: color-mix(in srgb, var(--success) 16%, transparent) !important;
      box-shadow: 0 0 0 1px color-mix(in srgb, var(--success) 32%, transparent) inset;
    }
    .celebrate .check{
      background: var(--success) !important;
      border-color: transparent !important;
      box-shadow: 0 0 0 6px color-mix(in srgb, var(--success) 18%, transparent);
    }
    .celebrate .check svg{ opacity:1 !important; }

    /* Confetti layer */
    #confettiLayer{
      position: fixed;
      inset: 0;
      pointer-events: none;
      overflow: hidden;
      z-index: 50;
    }
    .confetti{
      position: absolute;
      width: 7px;
      height: 7px;
      border-radius: 2px;
      opacity: .95;
      will-change: transform, opacity;
      filter: saturate(1.05);
    }

    .check{
      width: 22px;
      height: 22px;
      border-radius: 8px;
      border:1px solid var(--hair);
      display:grid;
      place-items:center;
      flex: 0 0 auto;
      cursor:pointer;
      user-select:none;
    }

    .check svg{ opacity:0; }

    .done .check{
      border-color: transparent;
      background: color-mix(in srgb, var(--text) 88%, transparent);
    }

    .done .check svg{ opacity:1; }

    .text{
      flex:1 1 auto;
      font-size: 16px;
      line-height: 1.35;
      word-break: break-word;
    }

    .done .text{
      color: var(--muted);
      text-decoration: line-through;
      text-decoration-thickness: 1.5px;
      text-decoration-color: color-mix(in srgb, var(--muted) 70%, transparent);
    }

    .icon{
      width: 34px;
      height: 34px;
      border-radius: 12px;
      display:grid;
      place-items:center;
      border:1px solid transparent;
      background: transparent;
      color: var(--muted);
      cursor:pointer;
      flex: 0 0 auto;
    }

    .icon:hover{ background: var(--soft); color: var(--text); }
    .icon:focus-visible{ outline:3px solid var(--focus); outline-offset:2px; }

    .foot{
      padding: 0 18px 18px 18px;
      color: var(--muted);
      font-size: 13px;
      line-height: 1.45;
    }

    .foot b{ color: var(--text); font-weight: 600; }

    .toast{
      position: fixed;
      left: 50%;
      bottom: 22px;
      transform: translateX(-50%);
      background: color-mix(in srgb, var(--bg) 78%, var(--soft));
      border: 1px solid var(--hair);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: var(--shadow);
      color: var(--text);
      font-size: 13px;
      opacity: 0;
      pointer-events:none;
      transition: opacity .18s ease, transform .18s ease;
    }

    .toast.show{ opacity:1; transform: translateX(-50%) translateY(-2px); }

    /* Motion + feedback (subtle, memorable) */
    .btn{ transition: background .18s ease, transform .18s ease, color .18s ease, border-color .18s ease; }
    .btn.pop{ animation: pop .22s cubic-bezier(.2,.9,.2,1); }

    .row{ transition: background .15s ease, transform .18s ease, opacity .18s ease, max-height .22s ease, margin .22s ease, padding .22s ease; }
    .row.enter{ animation: rowIn .34s cubic-bezier(.2,.85,.2,1); }
    .row.pulse{ animation: pulse .26s cubic-bezier(.2,.85,.2,1); }
    .row.exit{
      overflow:hidden;
      opacity:0;
      transform: translateY(-6px) scale(.985);
      max-height:0 !important;
      padding-top:0 !important;
      padding-bottom:0 !important;
      margin-top:0 !important;
      margin-bottom:0 !important;
    }

    .check{ transition: transform .18s ease, background .22s ease, border-color .22s ease, box-shadow .22s ease; }
    .check:active{ transform: scale(.94); }
    .check svg{ transition: opacity .18s ease; }
    .check path{ stroke-dasharray: 24; stroke-dashoffset: 24; transition: stroke-dashoffset .22s ease; }
    .done .check path{ stroke-dashoffset: 0; }
    .no-check-anim .check path{ stroke-dashoffset: 24 !important; }

    .icon{ transition: background .15s ease, transform .18s ease, color .18s ease; }
    .icon:active{ transform: scale(.96); }

    @keyframes rowIn{ from{ opacity:0; transform: translateY(10px) scale(.985);} to{ opacity:1; transform:none;} }
    @keyframes pop{ 0%{ transform: scale(1);} 45%{ transform: scale(1.03);} 100%{ transform: scale(1);} }
    @keyframes pulse{ 0%{ transform: scale(1);} 40%{ transform: scale(1.01);} 100%{ transform: scale(1);} }

    @media (prefers-reduced-motion: reduce){
      .btn:active{ transform:none; }
      .toast{ transition:none; }
      .row.enter, .row.pulse, .btn.pop{ animation:none; }
      .row, .btn, .check, .icon, .check path{ transition:none; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="app">
      <header>
        <div class="brand">
          <div class="title">AirTasks</div>
          <div class="sub">Tasks are saved on your device. You can share the list using the link.</div>
        </div>
        <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap; justify-content:flex-end;">
          <a class="btn" id="contributeBtn" href="https://github.com/iamdinakar/AirTasks" target="_blank" rel="noopener noreferrer" title="Open GitHub repository" aria-label="Contribute on GitHub">
            <svg width="16" height="16" viewBox="0 0 24 24" aria-hidden="true" fill="currentColor">
              <path d="M12 2C6.48 2 2 6.58 2 12.26c0 4.5 2.87 8.32 6.84 9.67.5.1.68-.22.68-.48 0-.24-.01-.86-.01-1.69-2.78.62-3.37-1.1-3.37-1.1-.45-1.19-1.11-1.5-1.11-1.5-.9-.64.07-.63.07-.63 1 .07 1.53 1.06 1.53 1.06.89 1.57 2.34 1.12 2.91.85.09-.67.35-1.12.63-1.38-2.22-.26-4.56-1.15-4.56-5.1 0-1.13.39-2.05 1.03-2.77-.1-.26-.45-1.3.1-2.71 0 0 .84-.28 2.75 1.06.8-.23 1.65-.34 2.5-.35.85.01 1.7.12 2.5.35 1.9-1.34 2.75-1.06 2.75-1.06.55 1.41.2 2.45.1 2.71.64.72 1.03 1.64 1.03 2.77 0 3.96-2.34 4.84-4.57 5.1.36.32.68.96.68 1.94 0 1.4-.01 2.53-.01 2.88 0 .26.18.58.69.48A10.17 10.17 0 0 0 22 12.26C22 6.58 17.52 2 12 2z"/>
            </svg>
            <span class="label">Contribute</span>
          </a>
          <button class="btn" id="shareBtn" type="button" title="Copy shareable link">
            <span class="label">Share link</span>
          </button>
        </div>
      </header>

      <div class="panel" role="application" aria-label="Task list">
        <div class="composer">
          <div class="field" aria-label="Add a task">
            <input id="taskInput" autocomplete="off" placeholder="Add a task" />
          </div>
          <button class="btn" id="addBtn" type="button" title="Add task">
            <span aria-hidden="true">+</span>
            <span class="label">Add</span>
          </button>
        </div>

        <div class="toolbar">
          <div class="meta" id="stats">0 tasks</div>
          <div class="actions">
            <button class="btn ghost" id="clearDoneBtn" type="button" title="Remove completed tasks">Clear done</button>
            <button class="btn ghost" id="resetBtn" type="button" title="Remove all tasks">Reset</button>
          </div>
        </div>

        <ul id="list" aria-label="Tasks"></ul>

        <div class="foot">
          <b>Privacy:</b> nothing is sent to a server. Saved in <b>local storage</b> and in the <b>link</b> when you share.
        </div>
      </div>
    </div>
  </div>

  <div id="confettiLayer" aria-hidden="true"></div>
  <div class="toast" id="toast" aria-live="polite"></div>

  <script>
  (() => {
    "use strict";

    const LS_KEY = "airtasks:v2";
    const MAX_HASH_CHARS_SOFT = 6000; // keep links reasonable

    const $ = (id) => document.getElementById(id);
    const listEl = $("list");
    const inputEl = $("taskInput");
    const statsEl = $("stats");
    const toastEl = $("toast");

    const state = { v: 1, tasks: [] };

    // For micro-animations after re-render
    let lastAddedId = null;
    let lastToggledId = null;
    let lastToggledToDone = false;
    let lastCelebratedId = null;

    const uid = () => Math.random().toString(36).slice(2) + Date.now().toString(36);

    function toast(msg){
      toastEl.textContent = msg;
      toastEl.classList.add("show");
      clearTimeout(toast._t);
      toast._t = setTimeout(() => toastEl.classList.remove("show"), 1400);
    }

    // base64url UTF-8 helpers
    function toBase64Url(str){
      const bytes = new TextEncoder().encode(str);
      let bin = "";
      const chunk = 0x8000;
      for (let i = 0; i < bytes.length; i += chunk){
        bin += String.fromCharCode(...bytes.subarray(i, i + chunk));
      }
      return btoa(bin).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/g,"");
    }

    function fromBase64Url(b64url){
      const b64 = b64url.replace(/-/g,"+").replace(/_/g,"/");
      const pad = b64.length % 4 ? "=".repeat(4 - (b64.length % 4)) : "";
      const bin = atob(b64 + pad);
      const bytes = new Uint8Array(bin.length);
      for (let i = 0; i < bin.length; i++) bytes[i] = bin.charCodeAt(i);
      return new TextDecoder().decode(bytes);
    }

    function serialize(){
      return JSON.stringify({
        v: 1,
        t: state.tasks.map(x => [x.id, x.text, x.done ? 1 : 0])
      });
    }

    function deserialize(jsonStr){
      const obj = JSON.parse(jsonStr);
      if (!obj || obj.v !== 1 || !Array.isArray(obj.t)) throw new Error("Bad payload");
      return obj.t.map(row => ({
        id: String(row[0] ?? uid()),
        text: String(row[1] ?? "").trim(),
        done: !!row[2]
      })).filter(x => x.text.length > 0);
    }

    function writeLocal(){
      try { localStorage.setItem(LS_KEY, serialize()); } catch {}
    }

    function writeHash(){
      const encoded = toBase64Url(serialize());
      const next = "#" + encoded;
      if (next.length > MAX_HASH_CHARS_SOFT){
        toast("Link too long. Saved on device.");
        return;
      }
      history.replaceState(null, "", next);
    }

    function persist(){
      writeLocal();
      writeHash();
      render();
    }

    function loadFromHash(){
      const raw = location.hash.slice(1).trim();
      if (!raw) return false;
      try{
        const json = fromBase64Url(raw);
        state.tasks = deserialize(json);
        writeLocal();
        return true;
      }catch{
        return false;
      }
    }

    function loadFromLocal(){
      try{
        const raw = localStorage.getItem(LS_KEY);
        if (!raw) return false;
        state.tasks = deserialize(raw);
        return true;
      }catch{
        return false;
      }
    }

    function init(){
      const okHash = loadFromHash();
      if (!okHash) loadFromLocal();
      render();
      inputEl.focus();

      // Optional internal tests: add ?test=1 to URL
      if (new URLSearchParams(location.search).get("test") === "1") runTests();
    }

    function addTask(text){
      const t = (text ?? "").trim();
      if (!t) return;
      const id = uid();
      state.tasks.unshift({ id, text: t, done: false });
      lastAddedId = id;
      inputEl.value = "";
      persist();
    }

    function toggleTask(id){
      const t = state.tasks.find(x => x.id === id);
      if (!t) return;
      t.done = !t.done;
      lastToggledId = id;
      lastToggledToDone = t.done;
      lastCelebratedId = t.done ? id : null;
      persist();
    }

    function deleteTask(id){
      const i = state.tasks.findIndex(x => x.id === id);
      if (i < 0) return;
      state.tasks.splice(i, 1);
      persist();
    }

    function clearDone(){
      const before = state.tasks.length;
      state.tasks = state.tasks.filter(x => !x.done);
      const removed = before - state.tasks.length;
      persist();
      toast(removed ? `Cleared ${removed}` : "No completed tasks");
    }

    function resetAll(){
      state.tasks = [];
      persist();
      toast("Reset");
    }

    function statsText(){
      const total = state.tasks.length;
      const done = state.tasks.filter(x => x.done).length;
      const left = total - done;
      if (total === 0) return "0 tasks";
      if (done === 0) return `${total} task${total===1?"":"s"}`;
      return `${left} left · ${done} done`;
    }

    function render(){
      const addedId = lastAddedId;
      const toggledId = lastToggledId;
      const toggledToDone = lastToggledToDone;
      const celebratedId = lastCelebratedId;

      // clear one-shot flags
      lastAddedId = null;
      lastToggledId = null;
      lastToggledToDone = false;
      lastCelebratedId = null;

      statsEl.textContent = statsText();
      listEl.innerHTML = "";

      if (state.tasks.length === 0){
        const li = document.createElement("li");
        li.className = "row";
        li.style.border = "1px dashed var(--hair)";
        li.style.background = "transparent";
        li.style.margin = "10px";
        li.style.padding = "16px 14px";
        li.innerHTML = `<div class="text" style="color:var(--muted)">Add a task. Use “Share link” to copy the list URL.</div>`;
        listEl.appendChild(li);
        return;
      }

      for (const t of state.tasks){
        const li = document.createElement("li");
        li.className = "row" + (t.done ? " done" : "");
        li.dataset.id = t.id;

        if (t.id === addedId) li.classList.add("enter");
        if (t.id === toggledId) li.classList.add("pulse");

        const shouldDrawCheck = (t.id === toggledId && toggledToDone && t.done);
        const shouldCelebrate = (t.id === celebratedId && toggledToDone && t.done);

        if (shouldCelebrate) li.classList.add("celebrate");
        if (shouldDrawCheck) li.classList.add("no-check-anim");

        const check = document.createElement("div");
        check.className = "check";
        check.setAttribute("role","checkbox");
        check.setAttribute("tabindex","0");
        check.setAttribute("aria-checked", t.done ? "true" : "false");
        check.title = "Mark done";
        check.innerHTML = `
          <svg width="14" height="14" viewBox="0 0 16 16" fill="none" aria-hidden="true">
            <path d="M13.5 4.5L6.6 11.4L3 7.8" stroke="white" stroke-width="2.2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        `;

        const txt = document.createElement("div");
        txt.className = "text";
        txt.textContent = t.text;

        const del = document.createElement("button");
        del.className = "icon";
        del.type = "button";
        del.title = "Delete";
        del.setAttribute("aria-label","Delete task");
        del.innerHTML = `
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <path d="M7 7l10 10M17 7L7 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        `;

        check.addEventListener("click", () => toggleTask(t.id));
        check.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " "){
            e.preventDefault();
            toggleTask(t.id);
          }
        });

        del.addEventListener("click", () => {
          li.style.maxHeight = li.offsetHeight + "px";
          li.classList.add("exit");
          setTimeout(() => deleteTask(t.id), 190);
        });

        li.appendChild(check);
        li.appendChild(txt);
        li.appendChild(del);
        listEl.appendChild(li);

        if (shouldDrawCheck){
          requestAnimationFrame(() => li.classList.remove("no-check-anim"));
        }
        if (shouldCelebrate){
          requestAnimationFrame(() => fireConfettiAt(check));
          setTimeout(() => li.classList.remove("celebrate"), 950);
        }
      }
    }

    async function shareLink(){
      writeHash();
      const url = location.href;
      try{
        await navigator.clipboard.writeText(url);
        toast("Link copied");
      }catch{
        const ta = document.createElement("textarea");
        ta.value = url;
        ta.style.position = "fixed";
        ta.style.left = "-9999px";
        document.body.appendChild(ta);
        ta.select();
        document.execCommand("copy");
        document.body.removeChild(ta);
        toast("Link copied");
      }
    }

    function popButton(el){
      if (!el) return;
      el.classList.remove("pop");
      void el.offsetWidth;
      el.classList.add("pop");
    }

    const prefersReducedMotion = () => window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

    function fireConfettiAt(anchorEl){
      if (!anchorEl || prefersReducedMotion()) return;

      const layer = document.getElementById("confettiLayer");
      if (!layer) return;

      const r = anchorEl.getBoundingClientRect();
      const x = r.left + r.width * 0.5;
      const y = r.top + r.height * 0.45;

      const colors = [
        "#22c55e", "#16a34a", "#4ade80", "#a3e635", "#facc15",
        "rgba(255,255,255,.92)"
      ];

      const pieces = 16;
      for (let i = 0; i < pieces; i++){
        const p = document.createElement("div");
        p.className = "confetti";

        const size = 5 + Math.random() * 5;
        p.style.width = size + "px";
        p.style.height = (size * (0.6 + Math.random() * 0.8)) + "px";
        p.style.borderRadius = (2 + Math.random() * 3) + "px";
        p.style.background = colors[(Math.random() * colors.length) | 0];

        p.style.left = (x - size / 2) + "px";
        p.style.top = (y - size / 2) + "px";

        layer.appendChild(p);

        const angle = (Math.random() * Math.PI * 2);
        const power = 70 + Math.random() * 140;
        const dx = Math.cos(angle) * power;
        const dy = Math.sin(angle) * power - (120 + Math.random() * 120);
        const spin = (Math.random() * 720 - 360);

        const duration = 820 + Math.random() * 420;
        const drift = 90 + Math.random() * 160;

        const anim = p.animate([
          { transform: `translate(0px, 0px) rotate(0deg)`, opacity: 1 },
          { transform: `translate(${dx}px, ${dy}px) rotate(${spin * 0.6}deg)`, opacity: 1, offset: 0.65 },
          { transform: `translate(${dx * 1.15}px, ${dy + drift}px) rotate(${spin}deg)`, opacity: 0 }
        ], {
          duration,
          easing: "cubic-bezier(.2,.8,.2,1)",
          fill: "forwards"
        });

        anim.onfinish = () => p.remove();
      }
    }

    // --- Lightweight in-page tests (run with ?test=1) ---
    function runTests(){
      const results = [];
      const ok = (name, cond) => results.push({ name, pass: !!cond });
      const eq = (name, a, b) => results.push({ name, pass: Object.is(a,b), got: a, expected: b });

      // Test 1: base64url roundtrip
      const s = "Hello ✓ 你好 مرحبا";
      eq("base64url roundtrip", fromBase64Url(toBase64Url(s)), s);

      // Test 2: serialize/deserialize roundtrip
      const snap = JSON.stringify(state);
      state.tasks = [
        { id: "a", text: "Task one", done: false },
        { id: "b", text: "Task two", done: true }
      ];
      const tasks2 = deserialize(serialize());
      ok("deserialize returns 2 tasks", tasks2.length === 2);
      eq("task b done", tasks2[1].done, true);

      // Test 3: render empty should not throw even if flags set
      state.tasks = [];
      lastToggledId = "x";
      lastToggledToDone = true;
      lastCelebratedId = "x";
      try { render(); ok("render empty no throw", true); } catch(e){ ok("render empty no throw", false); }

      // Test 4: flags are cleared after render
      state.tasks = [{ id: "x", text: "X", done: true }];
      lastToggledId = "x";
      lastToggledToDone = true;
      lastCelebratedId = "x";
      render();
      ok("lastCelebratedId cleared", lastCelebratedId === null);

      // Restore
      try { Object.assign(state, JSON.parse(snap)); } catch {}

      ok("fireConfettiAt exists", typeof fireConfettiAt === "function");

      const passed = results.filter(r => r.pass).length;
      console.log("AirTasks tests:", results);
      toast(`Tests: ${passed}/${results.length}`);
    }

    // Events
    $("addBtn").addEventListener("click", () => {
      popButton($("addBtn"));
      addTask(inputEl.value);
    });
    inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter"){
        popButton($("addBtn"));
        addTask(inputEl.value);
      }
    });
    $("shareBtn").addEventListener("click", () => {
      popButton($("shareBtn"));
      shareLink();
    });

    const contributeEl = $("contributeBtn");
    if (contributeEl){
      contributeEl.addEventListener("click", () => popButton(contributeEl));
    }

    $("clearDoneBtn").addEventListener("click", clearDone);
    $("resetBtn").addEventListener("click", resetAll);

    window.addEventListener("hashchange", () => {
      if (loadFromHash()){
        render();
        toast("Loaded from link");
      }
    });

    init();
  })();
  </script>
</body>
</html>
